<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Strategy Planning for the Fall 2024 Election</title>
    <!-- You can add additional styles or link to external stylesheets here -->
    <link rel="stylesheet" type="text/css" href="./styles/main.css">
</head>
<body>
    <header>
        <h1>Strategy Planning for the Fall 2024 Election</h1>
    </header>
    <main>
        <div class="content">
            <h2>The "Effort Remaining" Metric</h2>
            <h4>Mapping the "527 Field Plan" columns:</h4>
            <pre><code>
                ### get Paul's field plan
                field_plan = ReadFieldPlanFromGoogleSheets(google_sheet_id, tab_name, columns_to_keep,  api_key_path)
                field_plan['GEOID'] = field_plan['GEOID'].apply(lambda x: str(x))
                field_plan['CNTY_FIPS'] = field_plan['CNTY_FIPS'].fillna(0).apply(lambda x: int(x))
                field_plan = field_plan.rename(columns = {'PRIORITY LEVEL':'PRIORITY_LEVEL', 
                                            '18Evers':'Evers18', '20Biden':'Biden20', 
                                            '22Evers':'Evers22', 'Total Doors':'TotalDoors', 'VAP 2020':'VAP2020',
                                            'IDs-4/4 IDs (High opp)':'NewIDs',     # column DQ
                                            'Total (50-100 VCI)':'ModeledIDs',     # column CI
                                            'Expected Minimum':'ExpectedMinimum',  # column DL
                                            'Supporter Goal':'SupporterGoal',      # column DM
                                            'Effort Remaining':'EffortRemaining'}) # column DR

                field_plan['id'] = field_plan['WARD_FIPS']
                field_plan['z_layer'] = np.zeros(len(field_plan), dtype=int)

            </code></pre>
            <h4>Computing the "Effort Remaining":</h4>
            <pre><code>
                def ComputeEffortRequired(df, win_factor = 1.10, coefficient_2024 = .84):
                    ### fill in missing values in these columns with the mean of the others
                    df.fillna({'Biden20': df['Biden20'].mean(), 
                            'Evers18': df['Evers18'].mean(), 
                            'Evers22': df['Evers22'].mean(),
                            'ModeledIDs': 0,  # fill im missing values with 0
                            'NewIDs': 0}, inplace=True)
                    
                    # check each row of the spreadsheet ...
                    for row in df.itertuples():
                        # in cases where the column value for "Supporter Goal" is missing...
                        if row.SupporterGoal != row.SupporterGoal: 
                            try:  # try to calculate the SupporterGoal ...
                                df.at[row.Index,'SupporterGoal'] = max(row.Evers22 / row.Evers18, row.Biden20 * 1.1)
                            except ZeroDivisionError:
                                df.at[row.Index,'SupporterGoal'] = row.Biden20 * 1.1
                
                    ### 'ModeledIDs' is column CI of the spreadsheet
                    ### 'NewIDs' is column DQ of the spreadsheet
                    for row in df.itertuples():
                        # in cases where the column value for "Effort Remaining" is missing...
                        if row.EffortRemaining != row.EffortRemaining:
                            df['EffortRemaining'] = row.SupporterGoal - (row.ModeledIDs + row.NewIDs)
                    
                    return df
            </code></pre>    
        </div>
        <div class = "content">
            <h2>Current Version Changes:</h2>
            <h4>Version of 8/3/24</h4>
            <p><ul>
                <li>Updated the "Effort Remaining" metric per our conversation of 8/2/24.</li>
                <li>Billboard is updated to display new "Effort remaining to goal" information.
                    <div class="image-container2"  justify-content="left" height = "500px" width = "600px" >
                        <img src="./static_image/Billboard_rev-2.png"> 
                    </div>           
                </li>
                <li>Colorbars for each turf are capped at "Effort remaining to goal" = 900 voters for all turfs. </li>
            </ul></p>
            <h4>Version of 7/30/24</h4>
            <p><ul>
                <li>"Effort Remaining" metric is updated per our conversation of 7/29/24 to reflect expectations for Kamala Harris.</li>
                <li>Billboard is updated to display new "Effort Remaining" information.

                    <div class="image-container2"  justify-content="left" height = "500px" width = "600px" >
                        <img src="./static_image/Billboard.png"> 
                    </div>           

                </li>
                <li>Colorbars for each turf use county-wide max and min values for effort remaining, to allow comparisons between turfs. </li>
                <li>Images for turfs in Brown and Racine Counties are added.</li>
                <li>Static images showing priority 1 and 2 wards per turf are added.</li>
            </ul></p>
            <h4>Version of 7/28/24</h4>
            <p><ul>
                <li>"Effort Remaining" metric is same as previous version, code is above.</li>
                <li>Only Priority 1 and 2 wards are outlined (in red) and colored for effort remaining.  Other wards are not colored.</li>
                <li>"Effort Remaining" colorscale remains as before.</li>
            </ul></p>
 
        </div>
        <div class = 'content'>
            <h2>Milwaukee and Suburban Wards by Turf and Effort Remaining</h2>
            "html_image\Milwaukee  County Turf C Effort Remaining by Ward.html"

            <div class="iframe-container">
                <iframe src="./html_image/Milwaukee County Turf A Effort Remaining by Ward.html" frameborder="0" scrolling = "no" height = "900px" width = "800px" class="embedded-page"></iframe>
            </div>

            <div class="iframe-container">
                <iframe src="./html_image/Milwaukee County Turf B Effort Remaining by Ward.html" frameborder="0" scrolling = "no" height = "700px" width = "1000px" class="embedded-page"></iframe>   
            </div>

            <div class="iframe-container">
                <iframe src="./html_image/Milwaukee County Turf C Effort Remaining by Ward.html" frameborder="0" scrolling = "no" height = "700px" width = "1000px" class="embedded-page"></iframe>
            </div>

            <div class="iframe-container">
                <iframe src="./html_image/Milwaukee County Turf D Effort Remaining by Ward.html" frameborder="0" scrolling = "no" height = "700px" width = "1000px" class="embedded-page"></iframe>
            </div>

            <div class="iframe-container">
                <iframe src="./html_image/Milwaukee County Turf E Effort Remaining by Ward.html" frameborder="0" scrolling = "no" height = "1100px" width = "1000px" class="embedded-page"></iframe>
            </div>

            <div class="iframe-container">
                <iframe src="./html_image/Racine County Turf All Effort Remaining by Ward.html" frameborder="0" scrolling = "no" height = "1100px" width = "1000px" class="embedded-page"></iframe>
            </div>

            <div class="iframe-container">
                <iframe src="./html_image/Brown County Turf All Effort Remaining by Ward.html" frameborder="0" scrolling = "no" height = "1100px" width = "1000px" class="embedded-page"></iframe>
            </div>
        </div>
    
        <div class = 'content'> 
            <h2>Turfs by Ward by Priority Level</h2>
            <div class="image-container"  justify-content="left">
                <img src="./static_image/Milwaukee County Turf A Wards by Priority Level.png"> 
            </div>

            <div class="image-container"  justify-content="left">
                <img src="./static_image/Milwaukee County Turf B Wards by Priority Level.png">
            </div>
            
            <div class="image-container"  justify-content="left">                
                <img src="./static_image/Milwaukee County Turf C Wards by Priority Level.png">
            </div> 

            <div class="image-container"  justify-content="left">                
                <img src="./static_image/Milwaukee County Turf D Wards by Priority Level.png">
            </div> 

            <div class="image-container"  justify-content="left">                
                <img src="./static_image/Milwaukee County Turf E Wards by Priority Level.png">
            </div> 

            <div class="image-container"  justify-content="left">                
                <img src="./static_image/Racine County Turf All Wards by Priority Level.png">
            </div> 
            
            <div class="image-container"  justify-content="left">                
                <img src="./static_image/Brown County Turf All Wards by Priority Level.png">
            </div>             
        </div>

        <div class="content">
            <h2>Target Cities by Ward by Priority Level and VAP by Race</h2>
            <div  >
                <img src="./static_image/Milwaukee Wards by Priority Level And VAP.png" height = "840px" width = "2500px">
            </div>
            <br><br>
            <div  >           
                <img src="./static_image/Racine Wards by Priority Level And VAP.png" height = "550px" width = "2500px" >
            </div>
            <br><br>
            <div  >
                <img src="./static_image/Green Bay Wards by Priority Level And VAP.png" height = "347px" width = "2500px">  
            </div>
        </div>
    </main>
    <footer>

        <p>Copyright Alan Nichols&copy; 2023</p>
    </footer>
</body>
</html>
